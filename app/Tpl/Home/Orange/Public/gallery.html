<!--弹出框-->
<div id="dialog">
  <ul>
    <li><a href="#tabs-1">在线图库</a></li>
    <li><a href="#tabs-2">本地上传</a></li>
  </ul>
  <div id="tabs-1">
    <div id="select">
      <select name="gallery_pic" id="gallery">
      </select>
    </div>
    <div id="imgList">
    </div>
  </div>
  <div id="tabs-2" style="min-height:100px;">
      <include file="Public:imgUpload" />
  </div>
</div>
<script>
/* 在线图片和本地上传切换 */
$("#dialog").tabs();

/* 获取图库列表 */
$.get(
    "{:U('Home/Gallery/getGalleryList')}",
    function(data){
        $("#gallery").html(data);
    });

/* 动态加载图片信息 */
function loadImgList(){
    $("#imgList").load(
        "{:U('Home/Gallery/showImgList')}",
        {gallery_id: $("#gallery").val()}
        );
}

/* 打开会话框 */
$("#changeImg").click(function(){
    $("#dialog").dialog("open");
    $("#gallery").change(function(){loadImgList()});
    loadImgList();
    });
$("#dialog").dialog({
    autoOpen: false,
    title: '选择图片',
    height: 400,
    width: 640,
    buttons: [
    {
        text: '确定',
        click: function(){
            var img_id = $("#selImgVal").val();
            if(img_id != null){
                $("#img").val(img_id);
                }
            $(this).dialog('close')}
    },
    {
        text: '取消',
        click: function(){ $(this).dialog('close')}
    }]
})

</script>
